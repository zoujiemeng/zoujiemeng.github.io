---
layout: post
title: "Ubuntu16.04系统下vim的安装配置指南"
tagline: ""
description: "Ubuntu16.04系统下vim的安装配置指南"
category: vim
tags: [vim,ubuntu,linux,ycm]
last_updated: 2017-04-01
---

vim作为老牌且经典的文本编辑器，其可扩展性非常高，是Linux下一款非常优秀的文本编辑器，但是起安装和配置的过程较复杂。这里记录下来，可做参考。

## vim的安装

1. 在github下载最新的源码：`git clone https://github.com/vim/vim.git`(强烈建议源码安装，直接用`apt install vim`安装可能导致其不支持最新的特性)

2. 安装相关依赖库：`apt install python3-dev lua5.1 gnome-core-devel libncurses5-dev libgnome2-dev libgnomeui-dev libgtk2.0-dev libatk1.0-dev libbonoboui2-dev libcairo2-dev libx11-dev libxpm-dev libxt-dev python-dev ruby-dev mercurial`

3. 进入vim文件夹：`ad vim/`

4. 设置相关参数：`./configure --with-features=huge --enable-rubyinterp --enable-pythoninterp --with-python-config-dir=/usr/lib/python2.7/config/ --enable-perlinterp --enable-gui=gtk2 --enable-cscope --enable-luainterp --enable-multibyte --prefix=/usr`

5. 编译：`make`

6. 安装：`make install`

7. 完成后进入vim，输入`:echo has('python')`，输出1则表示支持Python

## vim的配置

1. 安装vim的插件管理软件vundle：`git clone https://github.com/gmarik/vundle.git ~/.vim/bundle/vundle`

2. 找到备份的[.vimrc]({{site.url}}/assets/.vimrc)文件，将其复制到目录`~/`（该文件内容较多，具体设置有注释，可依据个人习惯修改）

3. 打开vim，输入`:PluginInstall`安装插件（语义补全插件ycm还需额外步骤）

## 语义补全插件ycm

ycm是一个非常高效实用的补全插件，几乎支持所有主流语言的语法补全，但是其安装也比较复杂，下面介绍ycm的两种安装方式

### ycm的Ubuntu Linux x64 快速安装方法

+ 可能的话，最好选用后面的完整安装方法，因为该快速安装方法可能造成一些模块和功能的缺失。安装之前，确定vim的版本在7.4以上，且支持Python

+ 进入ycm folder`cd ~/.vim/bundle/YouCompleteMe`

+ 如果需要对C-family语义的支持
  + 控制台命令：`./install.sh --clang-completer`
  + 若提示未安装cmake，则`apt install cmake`即可
  + 该方法需要在线下载clang包，大约180M，对网速有要求。若网速较慢，可选择常规完整安装方法

+ 如果不需要对C-family语义支持：`./install.sh`

+ 若需要支持C#，只需在上述控制台命令后添加`--omnisharp-complete`

### ycm的常规完整安装方法

+ 通过vundle安装好ycm插件后，手动下载libclang（若系统中已有现成的 libclang（自行源码编译或者发行套件中自带的），最好别用，YCM 作者强烈建议下载 LLVM 官网的提供预编译二进制文件，可避免各种奇葩问题。在 http://llvm.org/releases/download.html 找到最新版 LLVM，Pre-built Binaries 下选择适合你发行套件的最新版预编译二进制文件，下载并解压至自定义`路径`（该`路径`下直接是bin，include等文件）

+ 编译ycm共享库

```
cd ~ 
mkdir ycm_build 
cd ycm_build 
cmake -G "Unix Makefiles" -DUSE_SYSTEM_BOOST=ON -DPATH_TO_LLVM_ROOT=路径 ~/.vim/bundle/YouCompleteMe/third_party/ycmd/cpp
cmake --build . --target ycm_core
```

+ 找到备份的[.ycm_extra_conf.py]({{site.url}}/assets/.ycm_extra_conf.py)文件，将其复制到项目目录，即可在项目中应用设置，详见[ycm conf](https://github.com/yangyangwithgnu/use_vim_as_ide#基于语义的智能补全)
